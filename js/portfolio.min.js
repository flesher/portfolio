var _base,_base1,_base2,_ref,_ref1,_ref2,_ref3;null==(_ref=window.mFlesh)&&(window.mFlesh={}),null==(_ref1=(_base=window.mFlesh).Data)&&(_base.Data={}),null==(_ref2=(_base1=window.mFlesh).Templates)&&(_base1.Templates={}),null==(_ref3=(_base2=window.mFlesh).Sequences)&&(_base2.Sequences={}),mFlesh.mainload=function(){for(var e=mFlesh.mainload.arguments[0],s=e.length,o=0,t=[],a=0;s>a;a++)t[a]=new Image,t[a].onload=function(){o++,o===s&&$(window).trigger("startitup")},t[a].src=e[a]},mFlesh.preload=function(){for(var e=mFlesh.preload.arguments[0],s=e.length,o=0,t=[],a=0;s>a;a++)t[a]=new Image,t[a].onload=function(){o++,o===s&&$(".det-coverup").fadeOut(1e3)},t[a].src=e[a].image},mFlesh.workTemp=['<div class="project">','<a href="<%= link %>"><img src="<%= prImage %>"></a>','<div class="info">',"<h1><%= title %></h1>","<p><%= blurb %></p>",'<a href="<%= link %>">View</a>',"</div>","</div>"].join(""),mFlesh.workDetailTemp=['<div class="det-coverup">',"</div>",'<div class="det-content">','<a class="close-det" href="/portfolio/portfolio"><img src="img/close-icon.png" alt="close"/></a>','<div class="inner contain">','<div class="det-info">','<div class="info-inner">',"<h1><%= title %></h1>","<h2><%= client %></h2>","<p><%= desc %></p>","<p><%= desc2 %></p>",'<a class="launch" href="<%= launchLink %>" target="_blank"> <%= launchText %></a>',"</div>","</div>",'<div class="det-imgs">','<div class="img-inner">','<ul class="rslides contain"></ul>',"</div>","</div>","</div>","</div>"].join(""),mFlesh.additionalSlides=['<li class="add-slide">','<img src="<%= image %>" alt="duh"/>',"</li>"].join(""),function(){var e=Backbone.View.extend({render:function(e){var s=this,o=_.template(mFlesh.workDetailTemp),t=_.template(mFlesh.additionalSlides);s.$el.show(),$("body").css("overflow","hidden"),$.get("work.json",function(a){var n=o(a[e]),i=a[e].images,l=a[e].bgImage,r={};r.image=l,s.$el.append(n);for(var p=0;i.length>p;p++){var c=t(i[p]);$(".rslides").append(c)}$(".rslides").responsiveSlides({auto:!1,pager:!0,nav:!0,namespace:"transparent-btns"}),$(".det-content").css("background-image","url("+a[e].bgImage+")");var h=i.splice(0);h.push(r),$(".close-det").click(function(e){e.preventDefault(),Backbone.history.navigate("/",!0)}),mFlesh.preload(h)})},dump:function(){this.$el.empty(),this.$el.fadeOut(1e3),$(window).scrollTo(mFlesh.scrollTop,0),$("body").css("overflow","inherit")}}),s=new e({el:$("#project-detail")}),o=Backbone.Router.extend({routes:{"project/:name":"getProject","*actions":"defaultRoute"}}),t=new o;t.on("route:getProject",function(e){s.render(e)}),t.on("route:defaultRoute",function(){s.dump()}),Backbone.history.start()}(),function(e){var s=this;s.initTri=function(){var s,o=8,t=mFlesh.windowW/o,a=mFlesh.windowH/(t/2);e("#home").height(mFlesh.windowH),e("#home").width(mFlesh.windowW),e("#outer").css("top",mFlesh.windowH),_setUp();for(var n=0;a+1>n;n++){s=0==n%2?0:1;for(var i=0;o+1>i;i++){var l=new mFlesh.fourTriangles(i*t+t*s/2,n*t/2,t/2,255,255,255,.7);mFlesh.triangles.push(l)}}},_setUp=function(){function s(){mFlesh.el=e('<canvas id="canvas" width="'+o.w+'" height="'+o.h+'"/>').appendTo(e("#home")),"undefined"!=typeof FlashCanvas&&FlashCanvas.initElement(el[0]),e("#canvas").attr("width",o.w),e("#canvas").attr("height",o.w),mFlesh.canvas=e("#canvas")[0],mFlesh.ctx=mFlesh.canvas.getContext("2d")}var o={};return o.props={w:0,w:0},o.init=function(){o.w=mFlesh.windowW,o.h=mFlesh.windowH,s()},o.resize=function(){},o.init(),o}}.call(mFlesh,jQuery),function(){var e=this;e.fourTriangles=function(e,s,o,t,a,n,i){function l(){mFlesh.ctx.beginPath(),mFlesh.ctx.fillStyle="rgba("+c.props.r+","+c.props.g+","+c.props.b+","+c.props.a*c.props.a1*c.props.dA+")",mFlesh.ctx.moveTo(e,s),mFlesh.ctx.lineTo(e,s-o),mFlesh.ctx.lineTo(e-o,s),mFlesh.ctx.closePath(),mFlesh.ctx.fill(),mFlesh.ctx.beginPath(),mFlesh.ctx.fillStyle="rgba("+c.props.r+","+c.props.g+","+c.props.b+","+c.props.a*c.props.a2*c.props.dA+")",mFlesh.ctx.moveTo(e,s),mFlesh.ctx.lineTo(e,s-o),mFlesh.ctx.lineTo(e+o,s),mFlesh.ctx.closePath(),mFlesh.ctx.fill(),mFlesh.ctx.beginPath(),mFlesh.ctx.fillStyle="rgba("+c.props.r+","+c.props.g+","+c.props.b+","+c.props.a*c.props.a3*c.props.dA+")",mFlesh.ctx.moveTo(e,s),mFlesh.ctx.lineTo(e,s+o),mFlesh.ctx.lineTo(e-o,s),mFlesh.ctx.closePath(),mFlesh.ctx.fill(),mFlesh.ctx.beginPath(),mFlesh.ctx.fillStyle="rgba("+c.props.r+","+c.props.g+","+c.props.b+","+c.props.a*c.props.a4*c.props.dA+")",mFlesh.ctx.moveTo(e,s),mFlesh.ctx.lineTo(e,s+o),mFlesh.ctx.lineTo(e+o,s),mFlesh.ctx.closePath(),mFlesh.ctx.fill()}function r(){var e=.08,s=.04,o=0;c.props.mx<=c.props.x&&c.props.my<=c.props.y?(c.props.a1=e,c.props.a2=s,c.props.a3=s,c.props.a4=o):c.props.mx<c.props.x&&c.props.my>=c.props.y?(c.props.a1=s,c.props.a2=o,c.props.a3=e,c.props.a4=s):c.props.mx>=c.props.x&&c.props.my<c.props.y?(c.props.a1=s,c.props.a2=e,c.props.a3=o,c.props.a4=s):c.props.mx>c.props.x&&c.props.my>c.props.y&&(c.props.a1=o,c.props.a2=s,c.props.a3=s,c.props.a4=e)}function p(e,s){var o=Math.pow(e-c.props.x,2)+Math.pow(s-c.props.y,2),t=Math.sqrt(o);c.props.dA=.9*(1-t/(.8*mFlesh.windowW))}var c={};return c.props={x:0,y:0,w:0,r:0,g:0,b:0,a:0,a1:0,a2:0,a3:0,a4:0,mX:0,mY:0,dA:.3},c.init=function(){c.props.x=e,c.props.y=s,c.props.w=o,c.props.r=t,c.props.g=a,c.props.b=n,c.props.a=i,c.props.mx=0,c.props.my=0,r(),l()},c.update=function(e){c.props.mx=e.pageX,c.props.my=e.pageY,r(),p(c.props.mx,c.props.my),l()},c.init(),c}}.call(mFlesh,jQuery),$(document).ready(function(){var e,s,o;$(window).on("resize",function(){mFlesh.windowW=$(window).outerWidth(),mFlesh.windowH=$(window).outerHeight(),$("#canvas").remove(),mFlesh.triangles=[],mFlesh.initTri()}),o=function(){setTimeout(function(){$("#title").fadeIn(1e3)},500),setTimeout(function(){$("nav").fadeIn(500),$("nav").addClass("nav-show")},1500),setTimeout(function(){$("#scroll").fadeIn(500),$("#scroll").addClass("scroll-show"),$("body").css("overflow","inherit")},2e3)},s=_.template(mFlesh.workTemp),$.get("work.json",function(e){var o=[];for(var t in e){var a=e[t].prImage,n=s(e[t]);o.push(a),$("#work").append(n)}mFlesh.mainload(o)}),e=$("#contact h1"),$("#contact").css("min-height",$(window).outerHeight()),$(".sect-wrapper").height(mFlesh.windowH-(e.outerHeight(!0)+3)),$("#nav-about").click(function(e){e.preventDefault(),$.scrollTo("#about",750,{axis:"y"},"swing")}),$("#scroll a").click(function(e){e.preventDefault(),$.scrollTo("#about",750,{axis:"y"},"swing")}),$("#nav-work").click(function(e){e.preventDefault(),$.scrollTo("#work",750,{axis:"y"},"swing")}),$("#nav-contact").click(function(e){e.preventDefault(),$.scrollTo("#contact",750,{axis:"y"},"swing")}),mFlesh.windowW=$(window).outerWidth(),mFlesh.windowH=$(window).outerHeight(),mFlesh.triangles=[],mFlesh.initTri(),mFlesh.clear=function(){mFlesh.ctx.clearRect(0,0,mFlesh.windowW,mFlesh.windowH)},$(document).mousemove(function(e){mFlesh.clear();for(var s=0;mFlesh.triangles.length>s;s++)mFlesh.triangles[s].update(e)}),$(window).on("startitup",function(){$("#canvas")?($("#mainloader").fadeOut(1e3),setTimeout(function(){o()},1e3)):setTimeout(function(){$(window).trigger("startitup")},20)})}),$(window).on("scroll",function(){mFlesh.scrollTop=$(window).scrollTop(),aboutOffset=$("#about").offset().top,aboutDistance=aboutOffset-mFlesh.scrollTop,bg=$("nav").hasClass("nav-bg"),navHeight=$("nav").height(),workOffset=$("#work").offset().top,workDistance=workOffset-mFlesh.scrollTop,contOffset=$("#contact").offset().top,contDistance=contOffset-mFlesh.scrollTop,navHeight>aboutDistance&&!bg?$("nav").addClass("nav-bg"):aboutDistance>=navHeight&&$("nav").removeClass("nav-bg"),navHeight>aboutDistance&&workDistance>navHeight?($("nav li").removeClass("active"),$("#nav-about").parent().addClass("active")):navHeight>=workDistance&&contDistance>navHeight&&mFlesh.scrollTop+$(window).height()!=$(document).height()?($("nav li").removeClass("active"),$("#nav-work").parent().addClass("active")):navHeight>=contDistance||mFlesh.scrollTop+$(window).height()==$(document).height()?($("nav li").removeClass("active"),$("#nav-contact").parent().addClass("active")):$("nav li").removeClass("active")});